<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TRAKA Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
    }
    .btn-primary {
      background-color: #2563eb;
      transition: background-color 0.3s;
    }
    .btn-primary:hover {
      background-color: #1e40af;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800 transition-colors duration-300">
  <div class="max-w-4xl mx-auto px-4">
    <div class="flex justify-between items-center py-4">
      <span id="userNameDisplay" class="text-sm font-medium text-blue-700">Cikgu Heri</span>
      <div class="flex gap-2 items-center">
     <script>
  document.getElementById('logoutBtn').addEventListener('click', function () {
    // Terus redirect ke halaman login
    window.location.href = 'traka-login.html';
  });
</script>

        <button id="themeToggle" class="text-sm border rounded px-2 py-1">ðŸŒ“</button>
        <button id="logoutBtn" class="text-sm border rounded px-2 py-1 bg-red-600 text-white hover:bg-red-700">Logout</button>
        <select id="langSwitcher" class="text-sm border rounded px-2 py-1">
          <option value="ms">Bahasa Melayu</option>
          <option value="en">English (UK)</option>
        </select>
      </div>
    </div>

    <header class="bg-white shadow-md rounded-2xl p-6 mb-6 flex items-center gap-4">
      <div class="bg-blue-600 text-white font-bold rounded-full w-12 h-12 flex items-center justify-center text-xl">T</div>
      <div>
        <h1 class="text-3xl font-bold text-gray-800">TRAKA Dashboard</h1>
        <p class="text-sm text-gray-500" id="greetingText">Jejak perjalanan trading anda secara berdisiplin.</p>
      </div>
    </header>

    <section class="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-4 mb-6">
      <div class="bg-white p-4 rounded-2xl shadow text-center">
        <div class="text-3xl mb-2">ðŸ“Š</div>
        <h2 class="text-sm font-semibold">Jumlah Trade</h2>
        <p class="text-xl font-bold text-blue-600">52</p>
      </div>
      <div class="bg-white p-4 rounded-2xl shadow text-center">
        <div class="text-3xl mb-2">ðŸŽ¯</div>
        <h2 class="text-sm font-semibold">Win Rate</h2>
        <p class="text-xl font-bold text-green-600">68%</p>
      </div>
      <div class="bg-white p-4 rounded-2xl shadow text-center">
        <div class="text-3xl mb-2">ðŸ’°</div>
        <h2 class="text-sm font-semibold flex items-center justify-center gap-2">Profit Bulanan
          <select id="currencySelect" class="text-xs border rounded px-1 py-0.5">
            <option value="RM">MYR</option>
            <option value="$">USD</option>
            <option value="â‚¬">EUR</option>
            <option value="KY$">KYD</option>
          </select>
        </h2>
        <p id="profitAmount" class="text-xl font-bold text-yellow-600">RM3,200</p>
      </div>
      <div class="bg-white p-4 rounded-2xl shadow text-center">
        <div class="text-3xl mb-2">ðŸ“ˆ</div>
        <h2 class="text-sm font-semibold">Profit Factor</h2>
        <p class="text-xl font-bold text-purple-600">1.75</p>
      </div>
    </section>

    <section class="bg-white p-6 rounded-2xl shadow mb-6">
      <h2 class="text-lg font-semibold mb-4">Graf Prestasi Harian</h2>
      <canvas id="performanceChart" height="200"></canvas>
    </section>

    <section class="bg-white p-6 rounded-2xl shadow mb-6">
      <h2 class="text-lg font-semibold mb-4">Ulasan AI Harian</h2>
      <div class="bg-gray-50 p-4 rounded-xl border border-yellow-300">
        <p class="text-gray-800 italic">
          "Hari ini anda membuat 3 trade, dua daripadanya menggunakan teknik Breakout. Emosi anda kelihatan lebih tenang berbanding semalam. Elakkan entry semasa news besar."
        </p>
      </div>
    </section>

    <section class="bg-white p-6 rounded-2xl shadow mb-6">
      <h2 class="text-lg font-semibold mb-4">Ulasan AI Mingguan</h2>
      <div class="bg-gray-50 p-4 rounded-xl border border-blue-200">
        <p class="text-gray-800 italic">
          "Minggu ini anda lebih konsisten menggunakan teknik Taming Sari. Emosi tenang juga meningkat. Teruskan disiplin dan elakkan entry tergesa-gesa sebelum breakout sah."
        </p>
      </div>
    </section>

    <section class="bg-white p-6 rounded-2xl shadow mb-6">
      <h2 class="text-lg font-semibold mb-4">Muat Naik CSV dari MT5</h2>
      <div class="flex flex-col md:flex-row gap-4 mb-4">
        <input type="file" accept=".csv" id="csvUpload" class="p-2 border rounded w-full" />
        <select id="csvCurrency" class="p-2 border rounded">
          <option value="RM">MYR</option>
          <option value="$">USD</option>
          <option value="â‚¬">EUR</option>
          <option value="Â¥">JPY</option>
        </select>
      </div>
      <button onclick="parseCSVFile()" class="btn-primary text-white px-4 py-2 rounded">Upload & Import</button>
    </section>

    <form class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <input class="p-2 border rounded" type="date" required />
      <input class="p-2 border rounded" type="text" placeholder="Pair (cth: XAU/USD)" required />
      <select class="p-2 border rounded" required>
        <option value="">Pilih Setup</option>
        <option value="Dominan Candle">Dominan Candle</option>
        <option value="Breakout">Breakout</option>
        <option value="Taming Sari">Taming Sari</option>
      </select>
      <input class="p-2 border rounded" type="number" placeholder="Profit/Loss (RM)" required />
      <select class="p-2 border rounded" required>
        <option value="">Emosi Sebelum Trade</option>
        <option value="Tenang">Tenang</option>
        <option value="Takut">Takut</option>
        <option value="Tamak">Tamak</option>
      </select>
      <input class="p-2 border rounded" type="text" placeholder="Nota Ringkas (optional)" />
      <input class="p-2 border rounded" type="file" accept="image/*" id="chartImage" />
      <button class="col-span-1 md:col-span-2 btn-primary text-white py-2 rounded">Simpan Trade</button>
    </form>

    <section class="bg-white p-6 rounded-2xl shadow mb-10">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-lg font-semibold">Log Trade Terkini</h2>
        <select id="filterSetup" onchange="filterTable()" class="p-2 border rounded">
          <option value="">Tapis mengikut Setup</option>
          <option value="Dominan Candle">Dominan Candle</option>
          <option value="Breakout">Breakout</option>
          <option value="Taming Sari">Taming Sari</option>
        </select>
      </div>
      <table id="tradeTable" class="w-full table-auto text-sm">
        <thead>
          <tr class="bg-gray-200 text-gray-700">
            <th class="px-2 py-1 text-left">Tarikh</th>
            <th class="px-2 py-1 text-left">Pair</th>
            <th class="px-2 py-1 text-left">Setup</th>
            <th class="px-2 py-1 text-left">Profit/Loss</th>
            <th class="px-2 py-1 text-left">Emosi</th>
            <th class="px-2 py-1 text-left">Nota</th>
          </tr>
        </thead>
        <tbody>
          <!-- Data akan dipaparkan di sini -->
        </tbody>
      </table>
    </section>
  </div>
  <script>
    const ctx = document.getElementById('performanceChart').getContext('2d');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['Isnin', 'Selasa', 'Rabu', 'Khamis', 'Jumaat', 'Sabtu', 'Ahad'],
        datasets: [{
          label: 'Profit Harian (RM)',
          data: [50, -20, 80, 100, -30, 40, 90],
          borderColor: 'rgba(59, 130, 246, 1)',
          backgroundColor: 'rgba(59, 130, 246, 0.2)',
          fill: true,
          tension: 0.3
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });
  </script>
  <script>
  document.addEventListener("DOMContentLoaded", function () {
    const logoutButton = document.getElementById('logoutBtn');
    if (logoutButton) {
      logoutButton.addEventListener('click', function () {
        window.location.href = 'traka-login.html';
      });
    }
  });
</script>
  <script>
function parseCSVFile() {
  const fileInput = document.getElementById('csvUpload');
  const file = fileInput.files[0];
  if (!file) return alert('Sila pilih fail CSV terlebih dahulu.');

  const reader = new FileReader();
  reader.onload = function (e) {
    const text = e.target.result;
    const rows = text.split(/\r?\n/).filter(row => row.trim() !== '');

    const tbody = document.querySelector('#tradeTable tbody');
    tbody.innerHTML = ''; // Kosongkan sebelum tambah baru

    rows.forEach((row, index) => {
      const cols = row.split(',');
      if (cols.length >= 5 && index > 0) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="px-2 py-1">${cols[0]}</td>
          <td class="px-2 py-1">${cols[1]}</td>
          <td class="px-2 py-1">${cols[2]}</td>
          <td class="px-2 py-1">${cols[3]}</td>
          <td class="px-2 py-1">${cols[4]}</td>
          <td class="px-2 py-1">${cols[5] || '-'}</td>
        `;
        tbody.appendChild(tr);
      }
    });

    alert('Import CSV berjaya!');
  };
  reader.readAsText(file);
}
</script>

</body>
</html>
